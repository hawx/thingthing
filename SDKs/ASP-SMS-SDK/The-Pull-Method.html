<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>The Pull Method | Esendex Developers</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="description" content="Integrate SMS with your applications using the ASP SMS SDK. Pull SMS messages to your application inbox. Receive SMS messages direct to your applications with the Esendex SMS API." />
<meta name="robots" content="index,follow" />
<link rel="canonical" href="The-Pull-Method.html" />
<link rel="shortcut icon" href="/sites/all/themes/EsendexDevelopers/favicon.ico" type="image/x-icon" />
	<link type="text/css" rel="stylesheet" media="all" href="/sites/all/modules/codefilter/codefilter.css?n" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/aggregator/aggregator.css?n" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/node/node.css?n" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/system/defaults.css?n" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/system/system.css?n" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/system/system-menus.css?n" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/user/user.css?n" />
<link type="text/css" rel="stylesheet" media="all" href="/sites/all/modules/cck/theme/content-module.css?n" />
		<link rel="stylesheet" type="text/css" href="/sites/all/themes/EsendexDevelopers/css/style.css" />
	<link rel="stylesheet" type="text/css" href="/sites/all/themes/EsendexDevelopers/css/dev-style.css" />
	<link href="/sites/all/themes/EsendexDevelopers/css/tabify.css" rel="stylesheet" type="text/css" />
	<link rel="stylesheet" type="text/css" href="/sites/all/themes/EsendexDevelopers/css/bootstrap.css" />
	<link rel="stylesheet" type="text/css" href="/sites/all/themes/EsendexDevelopers/css/bootstrap-glyphicons.css" />
	<link rel="stylesheet" type="text/css" href="/sites/all/themes/EsendexDevelopers/css/google-code-prettify/prettify.css"/>
				<meta name="viewport" content="width=device-width, initial-scale=1">

	<!--[if IE 7]>
		<link rel="stylesheet" href="/sites/all/themes/EsendexDevelopers/css/IE7.css?v=1.0" type="text/css" media="screen" />
	<![endif]-->
	<!--[if lte IE 6]>
		<link rel="stylesheet" href="/sites/all/themes/EsendexDevelopers/css/IE6.css?v=1" type="text/css" media="screen" />
	<![endif]-->

	<!--[if IE 9]>
		<link rel="stylesheet" type="text/css" href="/sites/all/themes/EsendexDevelopers/css/IE9.css?v=0.1" />
	<![endif]-->

	<!-- javascript moved to the footer -->
	<!-- Google Analytics Starts -->

<script type="text/javascript">


  var _gaq = _gaq || [];

  _gaq.push(['_setAccount', 'UA-30969528-1']);

  _gaq.push(['_trackPageview']);

  (function() {

    var ga = document.createElement('script');

    ga.type = 'text/javascript'; ga.async = true;

    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';

    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);

  })();


</script>

<script type="text/javascript">
function trackOutboundLinks()
{
	var a = document.getElementsByTagName('a');

	for(i = 0; i < a.length; i++){

		if (a[i].href.indexOf(location.host) == -1 && a[i].href.match(/^http:\/\//i)){
			
			if(!a[i].onclick){ //check onclick event doesn't already exist
				a[i].onclick = function(){
					_gaq.push(['_trackEvent', 'outgoing_links', this.href.replace(/^http:\/\//i, '')]);
				}
			}
		}
	}
}

function trackLink(link, category, action, label) {
    try { 
        _gaq.push(['_trackEvent', category , action, label]); 
    } catch(err) {}
     
    setTimeout(function () {
        document.location.href = link.href;
    }, 100);
}

function trackClick(category, action, label) {
    try { 
        _gaq.push(['_trackEvent', category , action, label]); 
    } catch(err) {}
}

</script>

<!-- Google Analytics Ends -->


	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js"></script>
	<script src="/sites/all/themes/EsendexDevelopers/js/bootstrap-nav.js" type="text/javascript" charset="utf-8"></script>

</head>

<body onload="trackOutboundLinks()">
	<div id='wrapper'>
		<div id='bootstrapnav'class="container">
			<div class="row">

				<a href='../../node/714.html' title='Home'><img id='nav-logo' src='/sites/all/themes/EsendexDevelopers/images/esendex-logo.jpg' width='122px' height='39px' /><div id='dev-title'>Developers</div></a>
				<a href='https://www.esendex.com/home' id='nav-login'>Login</a>
				<div id='mobile-menu-opener'></div>

				  <div class="block block-menu" id="block-menu-primary-links">
    
    <div class="content"><ul class="menu"><li class="leaf first"><a href="../../node/714.html">Home</a></li>
<li class="expanded"><a href="../../Quickstarts/Send-SMS.html">Quickstarts</a><ul class="menu"><li class="leaf first"><a href="../../Quickstarts/Send-SMS.html" title="Send a SMS">Send SMS</a></li>
<li class="leaf"><a href="../../Quickstarts/Receive-Messages.html" title="Receive Messages">Receive SMS</a></li>
<li class="leaf"><a href="../../Quickstarts/Track-SMS.html" title="Track SMS">Track SMS</a></li>
<li class="leaf last"><a href="../../Quickstarts/Send-Survey.html" title="Send Survey with our API">Send Survey</a></li>
</ul></li>
<li class="expanded"><a href="../../APIs/EsendexAPI/index.html">APIs</a><ul class="menu"><li class="leaf first"><a href="../../APIs/EsendexAPI/index.html">REST API</a></li>
<li class="leaf"><a href="../../APIs/SOAP-SMS-API.html" title="SOAP XML SMS API">SOAP API</a></li>
<li class="leaf"><a href="../../APIs/FormPost-API.html" title="HTTP SMS API">FormPost API</a></li>
<li class="leaf"><a href="../../APIs/API-Comparison.html" title="API Comparison">Which API should I use?</a></li>
<li class="leaf last"><a href="../../Documentation/Push-Notifications.html">Push Notifications</a></li>
</ul></li>
<li class="expanded"><a href="../../SDKs.html" title="SDKs">SDKs</a><ul class="menu"><li class="leaf first"><a href="../DotNet-SDK.html" title=".Net Rest SDK">.NET SDK</a></li>
<li class="leaf"><a href="../Java-SDK.html">Java SDK</a></li>
<li class="leaf"><a href="../PHP-SDK.html" title="PHP Rest SDK">PHP SDK</a></li>
<li class="leaf"><a href="../Ruby-SDK.html">Ruby SDK</a></li>
<li class="leaf"><a href="../Go-SDK.html">Go SDK</a></li>
<li class="leaf"><a href="../Node-SDK.html">Node.js SDK</a></li>
<li class="divider leaf"><a href="../../node/714.html" >divider</a></li>
<li class="leaf"><a href="../C-SMS-SDK.html">C++ SDK</a></li>
<li class="leaf"><a href="../ActiveX-SMS-SDK.1.html">Classic ASP SDK</a></li>
<li class="leaf"><a href="../Delphi-SMS-SDK.html">Delphi SDK</a></li>
<li class="leaf"><a href="../Perl-SMS-SDK.html">Perl SDK</a></li>
<li class="leaf last"><a href="../Visual-Basic-SOAP-SDK.html">Visual Basic 6 SDK</a></li>
</ul></li>
<li class="dynamic-active leaf last"><a href="../../blog/index.html" >Blog</a></li>
</ul></div>
 </div>

			</div>
		</div>

<div id='headerspacer'></div> <!-- delete this and the sky will fall -->

<div id='three-cols-page'>
	<div>
		<div id='dev-content'>
	<h1 class="title">The Pull Method</h1>
		          <div class="node">
        
    
    
    <div class="content"><p>The pull method is essentially where you poll Esendex to see if there are any new Messages in your Inbox, below is an example of how to do it.</p>
<pre class="prettyprint lang-vb">function processForm()<br />on error resume next<br /><br />'Setup the service object<br />dim inboxService<br />set inboxService = Server.CreateObject("Esendex.InboxService.2") <br /><br />'Error Handling<br />if err.number &lt;&gt; 0 then<br />processForm = "Unable to create Esendex.InboxService.2 object. Ensure COM object is registered. Error description: " + err.Description <br />exit function<br />end if<br /><br />'Setup the send service object<br />inboxService.Initialise Request.Form("Username"), Request.Form("Password"), Request.Form("Account")<br /><br />'Attempt to retrieve the messages and handle any errors<br />dim messageArray<br />set messageArray = inboxService.GetMessages( )<br /><br />if err.number &lt;&gt; 0 then<br />'Display the generated error<br />processForm = "Unable to retrieve messages: " + err.Description<br /><br />on error goto 0<br />exit function<br />else<br />'Do something with the returned messages<br />Dim index<br />processForm = Cstr(messageArray.Count) + " messages were returned." + vbcrlf<br />for index = 1 TO messageArray.Count<br />processForm = processform + messageArray(index).body + vbcrlf<br />next<br /><br />on error goto 0<br />exit function<br />end if<br /><br />end function<br /></pre><p>As with the other examples you have to first create an instance of an Esendex service, this time it is the <strong>InboxService</strong>. Then you need to initialise the inbox with your account details.</p>
<pre class="prettyprint lang-vb">'Setup the send service object<br />inboxService.Initialise Request.Form("Username"), Request.Form("Password"), Request.Form("Account")<br /></pre><p>Now you can use the methods available on the Inbox Service class to receive Messages. When you receive a Message you get back a Message object as detailed here <a title="Recieve Text Message" href="Receive-Text-Message.html">Recieve SMS</a>. Simply declare a Message array object and assign it to the return value of the <strong>GetMessages</strong> method.</p>
<pre class="prettyprint lang-vb">dim messageArray<br />set messageArray = inboxService.GetMessages( )<br /></pre><p>Now you have an array of the Messages from your Inbox you can loop through the Messages and perform the appropriate actions for your application, for the purposes of this example the Message Bodies are simply output to the screen using a variable called processForm.</p>
<pre class="prettyprint lang-vb">processForm = Cstr(messageArray.Count) + " messages were returned." + vbcrlf<br />for index = 1 TO messageArray.Count<br />processForm = processform + messageArray(index).body + vbcrlf<br />next<br /></pre><p>One of the limitations of this method is that you can only get the first 50 Messages in your Inbox. Because of this, once you have downloaded a Batch of Messages and have stored them on your server or processed them in whatever way your business requires it is recommended that you delete them in order to get the next batch of Messages. The following code sample shows how to do this.</p>
<pre class="prettyprint lang-vb">'Generate a comma separated list of the ID's ready to use when deleting them<br />Dim index<br />Dim messageIDs<br />processForm = Cstr(messageArray.Count) + " messages were returned." + vbcrlf<br />for index = 1 TO messageArray.Count<br />'Comma separate the message id's<br />if index &gt; 1 then<br />messageIDs = messageIDs + ","<br />end if<br /><br />messageIDs = CStr(messageArray(index).id)<br />processForm = processform + messageArray(index).body + vbcrlf<br />next<br /><br />'Now attempt to delete the messages that were retrieved<br />inboxService.DeleteMessages messageIDs<br /></pre><p>The DeleteMessages method on the Inbox Service requires a comma separated list of Message Ids which is created from the Message array returned by the GetMessages method. Then you simply call DeleteMessages with this list as a parameter and you will delete the Messages from your Esendex Inbox. Now when you call GetMessages you will get the next 50 Messages in your inbox.</p>
</div>
      </div>
		</div>
	<div id='right-col'>

		   <div class="block block-block" id="block-block-37">
    
    <div class="content"><a href='../../create-an-account.html' id='CreateAccountButton' title='Create an account'>Create an account</a></div>
 </div>
  <div class="block block-block" id="block-block-66">
    
    <div class="content"><div>
	<p><a class="needahand" href="http://www.esendex.co.uk/Action/Contact-Us">Need a hand?</a></p>
</div></div>
 </div>
 
	</div>
	<div class='clear'></div>
	</div>
</div>
</div><!-- close wrapper -->

<div id='footerbg'>
	<div id='footer'>
            <div id='visit'><a href='http://www.esendex.com/'>Visit our commercial site</a></div>

		<ul id='footerlinks'>
			<li class='first'><a href='http://www.esendex.co.uk/reference/terms-and-conditions'>Terms and conditions</a></li>
			<li><a href='http://www.esendex.co.uk/reference/terms-of-use'>Terms of use</a></li>
			<li><a href='http://www.esendex.co.uk/reference/security'>Security</a></li>
			<li><a href='http://www.esendex.co.uk/reference/privacy'>Privacy</a></li>
			<li><a href='http://www.esendex.co.uk/reference/data-protection'>Data protection</a></li>
			<li class='last'><a href='http://www.esendex.co.uk/sla'>Service level agreement</a></li>
		</ul>
		<div id='copyright'>Esendex Limited 2016<br/>Registered company number: 04217280<br/>UK</div>
            
	</div>
</div>


<script src="/sites/all/themes/EsendexDevelopers/js/bootstrap.js" type="text/javascript" charset="utf-8"></script>
<script src="/sites/all/themes/EsendexDevelopers/js/google-code-prettify/prettify.js" type="text/javascript" charset="utf-8"></script>
<script src="/sites/all/themes/EsendexDevelopers/js/placeholders.js" type="text/javascript" charset="utf-8"></script>
<script src="/sites/all/themes/EsendexDevelopers/js/jquery.cookie.js" type="text/javascript" charset="utf-8"></script>
<script src="/sites/all/themes/EsendexDevelopers/js/codesamples.js" type="text/javascript" charset="utf-8"></script>

<script src="/sites/all/themes/EsendexDevelopers/js/intlTelInput.js" type="text/javascript" charset="utf-8"></script>
<script src="/sites/all/themes/EsendexDevelopers/js/customIntlTel.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript">
document.documentElement.className += " js"
/* <![CDATA[ */
	$(document).ready(function () {$('.carousel').carousel(); prettyPrint();  Placeholders.init(); });
/* ]]> */
</script>

<!--mobile nav-->
<script type="text/javascript">
	(function() {
		var menu = document.getElementById("block-menu-primary-links");
		var isOpen = menu.style.display=="block";

		document.getElementById("mobile-menu-opener").addEventListener("click",function() {
			if(isOpen) {
				menu.style.display = "";
				isOpen = false;
			} else {
				menu.style.display = "block";
				isOpen = true;
			}
		});
	})();
</script>
<!-- remarketing -->
<!-- Google Code for Viewed All Pages in the last 30 days Remarketing List -->
<script type="text/javascript">
/* <![CDATA[ */
var google_conversion_id = 1066303896;
var google_conversion_language = "en";
var google_conversion_format = "3";
var google_conversion_color = "666666";
var google_conversion_label = "82Y1CKTKzAEQmIO6_AM";
var google_conversion_value = 0;
/* ]]> */
</script>
<script type="text/javascript" src="http://www.googleadservices.com/pagead/conversion.js">
</script>
<noscript>
<div style="display:inline;" id="remarketing">
<img height="1" width="1" style="border-style:none;" alt="" src="http://www.googleadservices.com/pagead/conversion/1066303896/?label=82Y1CKTKzAEQmIO6_AM&amp;guid=ON&amp;script=0"/>
</div>
</noscript>

</body>
</html>
